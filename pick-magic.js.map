{"version":3,"sources":["assets/js/app/click-handler.js","assets/js/app/controller.js","assets/js/app/pwa.js","assets/js/app/search-service.js","assets/js/app/song-history.js","assets/js/app/song-list-renderer.js","assets/js/app/song-list.js","assets/js/app/song-renderer.js","assets/js/app/song-repository.js"],"names":[],"mappings":"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","file":"pick-magic.js","sourcesContent":["/**\n * Okay, so why do we need this? Why a whole class to implement our own version\n * of click handling? Am I insane?\n *\n * Well, maybe, but not because of this.\n *\n * This class installs one single click handler on the whole document, and\n * evaluates which callback to call at click time, based on the element that has\n * been clicked. This allows us to swap out and rerender whole sections of the\n * DOM without having to reinstall a bunch of click handlers each time. This\n * nicely decouples the render logic from the click event management logic.\n */\n\nclass ClickHandler {\n\n  constructor() {\n    document.addEventListener('click', (e) => {this.handleClick(e)});\n    this.handlers = {};\n  }\n\n  handleClick(e) {\n    Object.keys(this.handlers).forEach((selector) => {\n      if (e.target.matches(selector)) {\n        this.handlers[selector](e.target);\n      }\n    });\n  }\n\n  register(selector, callback) {\n    this.handlers[selector] = callback;\n  }\n\n}\n","window.addEventListener('load', function() {\n\n  let songRepository   = new SongRepository();\n  let songHistory      = new SongHistory(songRepository);\n  let songListRenderer = new SongListRenderer(document.getElementById(\"song-list\"));\n  let songRenderer     = new SongRenderer(document.getElementById(\"song\"));\n  let clickHandler     = new ClickHandler();\n  let searchService    = new SearchService();\n\n  clickHandler.register('[data-page-link]', selectPage);\n  clickHandler.register('[data-song-link]', selectSong);\n  clickHandler.register('[name=chords]',    searchChords);\n\n  // Bind a submit of the search form to the search function\n  document.querySelectorAll('#search-control').forEach(function(b) {\n    b.addEventListener('submit', searchSong);\n  });\n\n  // Bootstrap song list\n  renderHistory();\n\n  // Helper functions\n\n  function selectPage(elm) {\n    document.querySelectorAll('.page').forEach((e) => {e.classList.remove('active')});\n    document.getElementById(elm.getAttribute('data-page-link')).classList.add('active');\n    window.scrollTo(0,0);\n  }\n\n  function selectSong(elm) {\n    let song = songRepository.getSong(elm.getAttribute('data-song-link'));\n    songRenderer.draw(song);\n    songHistory.add(song);\n    selectPage(elm);\n  }\n\n  function renderHistory() {\n    songListRenderer.draw(songHistory.getSongList(), 'Recent songs');\n  }\n\n  // Searching\n\n  function searchSong(e) {\n      e.preventDefault();\n      let query = document.getElementById(\"search-song\").value;\n      if ( query == \"\" ) { renderHistory(); return false; }\n      var request = new XMLHttpRequest();\n      request.open('GET', 'https://limitless-bastion-37095.herokuapp.com/api/songs?query='+encodeURIComponent(query), true);\n      request.onload = function() {\n        if (request.status >= 200 && request.status < 400) {\n          // Success!\n          try {\n            var song_list = JSON.parse(request.responseText);\n          } catch(e) {\n            console.log(\"Error parsing JSON: \", e);\n          }\n\n          let songlist = new SongList(song_list)\n          songRepository.add(songlist);\n          songListRenderer.draw(songlist, 'Search results');\n        } else {\n          console.log(\"Server returned an error:\", request);\n        }\n      };\n      request.onerror = function() { console.log(\"Could not connect\", request); };\n      request.send();\n      return false;\n  }\n\n  // Displaying lists of sings\n  function searchChords(e){\n    var chordsChecked = Array.from(document.getElementsByName('chords')).filter((checkbox) => checkbox.checked).map((checkbox) => `chord=${encodeURIComponent(checkbox.id)}`);\n    var query = chordsChecked.join('&');\n    if ( query == \"\" ) { renderHistory(); return false; }\n    var request = new XMLHttpRequest();\n    request.open('GET', 'https://limitless-bastion-37095.herokuapp.com/api/songs?'+ query, true);\n    request.onload = function() {\n      if (request.status >= 200 && request.status < 400) {\n        // Success!\n        try {\n          var song_list = JSON.parse(request.responseText);\n        } catch(e) {\n          console.log(\"Error parsing JSON: \", e);\n        }\n\n        let songlist = new SongList(song_list)\n        songRepository.add(songlist);\n        songListRenderer.draw(songlist, 'Filter results');\n      } else {\n        console.log(\"Server returned an error:\", request);\n      }\n    };\n    request.onerror = function() { console.log(\"Could not connect\", request); };\n    request.send();\n    return false;\n  }\n\n});\n","// Install Service worker\n\nif ('serviceWorker' in navigator) {\n  navigator.serviceWorker.register('service-worker.js');\n}\n\n// PWA install prompt\n//\n// let deferredPrompt;\n// window.addEventListener('beforeinstallprompt', (e) => {\n//   // Prevent Chrome 67 and earlier from automatically showing the prompt\n//   e.preventDefault();\n//   // Stash the event so it can be triggered later.\n//   deferredPrompt = e;\n//   // Show the install button\n//   document.querySelectorAll('.install-button').forEach(function(b) {\n//     b.classList.add('active');\n//     b.addEventListener('click', install2HS);\n//   });\n// });\n//\n// function install2HS() {\n//   // Hide install button\n//   document.querySelectorAll('.install-button').forEach(function(b) {\n//     b.classList.remove('active');\n//   });\n//\n//   deferredPrompt.prompt();\n//   deferredPrompt.userChoice.then((choiceResult) => {\n//     if (choiceResult.outcome !== 'accepted') {\n//       document.querySelectorAll('.install-button').forEach(function(b) {\n//         b.classList.add('active');\n//       });\n//     }\n//   });\n// }\n","// This is work in progress\n\nclass SearchService {\n\n  constructor() {\n    // Where does Bob's awesome API live?\n    this.webservice = \"https://limitless-bastion-37095.herokuapp.com/api/songs\";\n  }\n\n  searchSong(e) {\n    e.preventDefault();\n    let query = document.getElementById(\"search-song\").value;\n    if ( query == \"\" ) { renderHistory(); return false; }\n    var request = new XMLHttpRequest();\n    request.open('GET', 'https://limitless-bastion-37095.herokuapp.com/api/songs?query='+encodeURIComponent(query), true);\n    request.onload = function() {\n      if (request.status >= 200 && request.status < 400) {\n        // Success!\n        try {\n          var song_list = JSON.parse(request.responseText);\n        } catch(e) {\n          console.log(\"Error parsing JSON: \", e);\n        }\n\n        let songlist = new SongList(song_list)\n        songRepository.add(songlist);\n        songListRenderer.draw(songlist, 'Search results');\n      } else {\n        console.log(\"Server returned an error:\", request);\n      }\n    };\n    request.onerror = function() { console.log(\"Could not connect\", request); };\n    request.send();\n    return false;\n  }\n\n  // Displaying lists of sings\n  searchChords(e){\n    var chordsChecked = Array.from(document.getElementsByName('chords')).filter((checkbox) => checkbox.checked).map((checkbox) => `chord=${encodeURIComponent(checkbox.id)}`);\n    var query = chordsChecked.join('&');\n    if ( query == \"\" ) { renderHistory(); return false; }\n    var request = new XMLHttpRequest();\n    request.open('GET', 'https://limitless-bastion-37095.herokuapp.com/api/songs?'+ query, true);\n    request.onload = function() {\n      if (request.status >= 200 && request.status < 400) {\n        // Success!\n        try {\n          var song_list = JSON.parse(request.responseText);\n        } catch(e) {\n          console.log(\"Error parsing JSON: \", e);\n        }\n\n        let songlist = new SongList(song_list)\n        songRepository.add(songlist);\n        songListRenderer.draw(songlist, 'Filter results');\n      } else {\n        console.log(\"Server returned an error:\", request);\n      }\n    };\n    request.onerror = function() { console.log(\"Could not connect\", request); };\n    request.send();\n    return false;\n  }\n\n  _getRequest(url, callback) {\n    var request = new XMLHttpRequest();\n    request.open('GET', url, true);\n    request.onload = function() {\n      if (request.status >= 200 && request.status < 400) {\n        // Success!\n        try {\n          var song_list = JSON.parse(request.responseText);\n        } catch(e) {\n          console.log(\"Error parsing JSON: \", e);\n        }\n\n        let songlist = new SongList(song_list)\n        songRepository.add(songlist);\n        songListRenderer.draw(songlist, 'Filter results');\n      } else {\n        console.log(\"Server returned an error:\", request);\n      }\n    };\n    request.onerror = function() { console.log(\"Could not connect\", request); };\n    request.send();\n  }\n\n\n}\n","class SongHistory {\n\n  constructor(repository) {\n    this.repository = repository;\n  }\n\n  getSongList() {\n    return new SongList(this._list().map((id) => {\n      return this.repository.getSong(id);\n    }));\n  }\n\n  add(song) {\n    if ( this._includes(song) ) {\n      // Optional TODO: Push this song to the end of the list\n      return;\n    } else {\n      let songHistory = this._list();\n      songHistory.push(song.id);\n      songHistory = songHistory.slice(0,10);\n      localStorage.setItem('songHistory', JSON.stringify(songHistory));\n    }\n  }\n\n  _list() {\n    return JSON.parse(localStorage.getItem('songHistory') || \"[]\");\n  }\n\n  _includes(song) {\n    return this._list().includes(song.id);\n  }\n\n}\n","class SongListRenderer {\n\n  constructor(element) {\n    this.element = element;\n  }\n\n  draw(songlist, header) {\n    let list = '';\n    songlist.forEach((song) => {\n      list += `<li><a class='song-link' data-page-link='song-page' data-song-link='${song.id}'>${song.song_name} - ${song.artist_name}</a></li>`;\n    });\n\n    this.element.innerHTML = `\n      ${header ? `<h1>${header} (${songlist.length})</h1>` : ``}\n      <ul>\n        ${list}\n      </ul>\n    `;\n  }\n\n}\n","class SongList extends Array {\n\n  constructor(songs) {\n    super();\n    if (Array.isArray(songs)) {\n      songs.forEach((song) => {this.push(song);});\n    }\n  }\n\n}\n","class SongRenderer {\n\n  constructor(element) {\n    this.element = element;\n  }\n\n  draw(song) {\n    this.element.innerHTML = `\n      <h1>${song.song_name} - ${song.artist_name}</h1>\n      <pre>${this._markupChords(song.lyrics)}</pre>\n    `;\n  }\n\n  _markupChords(lyrics) {\n    return lyrics.replace(/\\[ch\\]([\\w\\#\\/\\\\]*)\\[\\/ch\\]/gi, \"<span class='chord'>$1</span>\");\n  }\n\n}\n","class SongRepository {\n\n  constructor() {\n    this.repository = JSON.parse(localStorage.getItem('songList') || \"{}\");\n  }\n\n  add(songlist) {\n    songlist.forEach((song) => {this._addSong(song, false);});\n    this._saveToLocalStorage();\n  }\n\n  getSong(id) {\n    return this.repository[id];\n  }\n\n  getSongList() {\n    return new SongList(Object.values(this.repository));\n  }\n\n  _addSong(song, saveToLocalStorage=true) {\n    this.repository[song.id] = song;\n    if ( saveToLocalStorage ) { this._saveToLocalStorage(); }\n  }\n\n  _saveToLocalStorage() {\n    localStorage.setItem('songList', JSON.stringify(this.repository));\n  }\n\n}\n"]}